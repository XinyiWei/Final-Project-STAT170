{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pyspark\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib as mpl\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "# import relevant parts of sklearn\n",
    "from sklearn import cluster, datasets\n",
    "from sklearn.preprocessing import scale\n",
    "from sklearn.decomposition import PCA\n",
    "from sklearn.cluster import KMeans\n",
    "\n",
    "from scipy.cluster import hierarchy\n",
    "\n",
    "%matplotlib inline\n",
    "plt.style.use('seaborn-whitegrid')\n",
    "\n",
    "import seaborn as sns\n",
    "from pyspark.sql import SparkSession\n",
    "\n",
    "spark = SparkSession.builder.config(\"spark.worker.memory\", \"8g\").appName(\"Python Spark SQL basic example\").getOrCreate()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Twitter Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "twitter = pd.read_parquet(\"sample.parquet\", engine='pyarrow', columns=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create_at</th>\n",
       "      <th>favorite_count</th>\n",
       "      <th>geo_tag_city_id</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>geo_tag_county_id</th>\n",
       "      <th>geo_tag_county_name</th>\n",
       "      <th>geo_tag_state_id</th>\n",
       "      <th>geo_tag_state_name</th>\n",
       "      <th>id</th>\n",
       "      <th>in_reply_to_status</th>\n",
       "      <th>in_reply_to_user</th>\n",
       "      <th>is_retweet</th>\n",
       "      <th>lang</th>\n",
       "      <th>place_country</th>\n",
       "      <th>place_country_code</th>\n",
       "      <th>place_full_name</th>\n",
       "      <th>place_id</th>\n",
       "      <th>place_name</th>\n",
       "      <th>place_place_type</th>\n",
       "      <th>retweet_count</th>\n",
       "      <th>text</th>\n",
       "      <th>user_create_at</th>\n",
       "      <th>user_description</th>\n",
       "      <th>user_followers_count</th>\n",
       "      <th>user_friends_count</th>\n",
       "      <th>user_id</th>\n",
       "      <th>user_lang</th>\n",
       "      <th>user_location</th>\n",
       "      <th>user_name</th>\n",
       "      <th>user_profile_image_url</th>\n",
       "      <th>user_screen_name</th>\n",
       "      <th>user_statues_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01T00:00:27.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>1230000.0</td>\n",
       "      <td>Hialeah</td>\n",
       "      <td>12086</td>\n",
       "      <td>Miami-Dade</td>\n",
       "      <td>12</td>\n",
       "      <td>Florida</td>\n",
       "      <td>682712957118185473</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Hialeah, FL</td>\n",
       "      <td>629f4a26fed69cd3</td>\n",
       "      <td>Hialeah</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>Tryna get it in real quick before the turn up....</td>\n",
       "      <td>2010-10-08</td>\n",
       "      <td>Music Producer...Engineer....Winner..Productio...</td>\n",
       "      <td>5205</td>\n",
       "      <td>1745</td>\n",
       "      <td>200013652</td>\n",
       "      <td>en</td>\n",
       "      <td>Where ever the wave at.</td>\n",
       "      <td>Chize.</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/6681745180...</td>\n",
       "      <td>ChizeOfficial</td>\n",
       "      <td>6181</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-01T00:02:31.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>620018.0</td>\n",
       "      <td>Dublin</td>\n",
       "      <td>6001</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>6</td>\n",
       "      <td>California</td>\n",
       "      <td>682713477715120128</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Dublin, CA</td>\n",
       "      <td>003253f0107acd32</td>\n",
       "      <td>Dublin</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>I'm running off on the plug right now https://...</td>\n",
       "      <td>2009-06-03</td>\n",
       "      <td>null</td>\n",
       "      <td>1942</td>\n",
       "      <td>1266</td>\n",
       "      <td>44515193</td>\n",
       "      <td>en</td>\n",
       "      <td>229✊- 478- 850</td>\n",
       "      <td>Brute Black Boobie</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/6782158858...</td>\n",
       "      <td>BuddyNoLove</td>\n",
       "      <td>145115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-01T00:03:24.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>5148952.0</td>\n",
       "      <td>Manassas</td>\n",
       "      <td>51683</td>\n",
       "      <td>Manassas</td>\n",
       "      <td>51</td>\n",
       "      <td>Virginia</td>\n",
       "      <td>682713698272677888</td>\n",
       "      <td>682713447738568705</td>\n",
       "      <td>71644485</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Manassas, VA</td>\n",
       "      <td>1f703799b3940c20</td>\n",
       "      <td>Manassas</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>@Twittles23 I plan on running around Katsucon ...</td>\n",
       "      <td>2008-06-09</td>\n",
       "      <td>Hentai NSX, lifting, food, cats, waifus.</td>\n",
       "      <td>49</td>\n",
       "      <td>55</td>\n",
       "      <td>15066662</td>\n",
       "      <td>en</td>\n",
       "      <td>Virginia</td>\n",
       "      <td>cosplayerkyo</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/6772800631...</td>\n",
       "      <td>cosplayerkyo</td>\n",
       "      <td>1621</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-01T00:06:42.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>1250575.0</td>\n",
       "      <td>Oakland Park</td>\n",
       "      <td>12011</td>\n",
       "      <td>Broward</td>\n",
       "      <td>12</td>\n",
       "      <td>Florida</td>\n",
       "      <td>682714528413540352</td>\n",
       "      <td>682713382223507457</td>\n",
       "      <td>1853895816</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Oakland Park, FL</td>\n",
       "      <td>b230af2256484995</td>\n",
       "      <td>Oakland Park</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>@KittyKnits Could be worse. I'm waiting for th...</td>\n",
       "      <td>2009-06-27</td>\n",
       "      <td>null</td>\n",
       "      <td>1625</td>\n",
       "      <td>2039</td>\n",
       "      <td>51540429</td>\n",
       "      <td>en</td>\n",
       "      <td>Ft. Lauderdale, Florida USA</td>\n",
       "      <td>Ray Lauderback</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/5936642848...</td>\n",
       "      <td>okfor1</td>\n",
       "      <td>20210</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-01T00:09:10.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>5351300.0</td>\n",
       "      <td>Olympia</td>\n",
       "      <td>53067</td>\n",
       "      <td>Thurston</td>\n",
       "      <td>53</td>\n",
       "      <td>Washington</td>\n",
       "      <td>682715151015907328</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Olympia, WA</td>\n",
       "      <td>375aa1ab4abd79b1</td>\n",
       "      <td>Olympia</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>Wishing you a happy and healthy 2016! See you ...</td>\n",
       "      <td>2012-10-06</td>\n",
       "      <td>The Capital City Marathon, Half Marathon, 5 Mi...</td>\n",
       "      <td>151</td>\n",
       "      <td>251</td>\n",
       "      <td>865405321</td>\n",
       "      <td>en</td>\n",
       "      <td>Olympia, WA</td>\n",
       "      <td>CapitalCityMarathon</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/5226124486...</td>\n",
       "      <td>CapCityMarathon</td>\n",
       "      <td>336</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-01T00:09:51.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>1304000.0</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>13121</td>\n",
       "      <td>Fulton</td>\n",
       "      <td>13</td>\n",
       "      <td>Georgia</td>\n",
       "      <td>682715319975211008</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Atlanta, GA</td>\n",
       "      <td>8173485c72e78ca5</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>city</td>\n",
       "      <td>0</td>\n",
       "      <td>Last person in the gym for the year! 💁🏻 @ L A ...</td>\n",
       "      <td>2010-10-25</td>\n",
       "      <td>take me to the gym?</td>\n",
       "      <td>30</td>\n",
       "      <td>58</td>\n",
       "      <td>207546325</td>\n",
       "      <td>en</td>\n",
       "      <td>Atlanta, GA</td>\n",
       "      <td>Morgan Brown</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/6824350692...</td>\n",
       "      <td>m0rgancar0l</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-01T00:10:00.000Z</td>\n",
       "      <td>0</td>\n",
       "      <td>1208150.0</td>\n",
       "      <td>Brandon</td>\n",
       "      <td>12057</td>\n",
       "      <td>Hillsborough</td>\n",
       "      <td>12</td>\n",
       "      <td>Florida</td>\n",
       "      <td>682715359535824896</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>False</td>\n",
       "      <td>en</td>\n",
       "      <td>United States</td>\n",
       "      <td>United States</td>\n",
       "      <td>Florida, USA</td>\n",
       "      <td>4ec01c9dbc693497</td>\n",
       "      <td>Florida</td>\n",
       "      <td>admin</td>\n",
       "      <td>0</td>\n",
       "      <td>#sanctuary (@ Fitness for $10 in Brandon, FL) ...</td>\n",
       "      <td>2009-03-24</td>\n",
       "      <td>Just a small town girl. Living in a lonely world.</td>\n",
       "      <td>162</td>\n",
       "      <td>282</td>\n",
       "      <td>26328877</td>\n",
       "      <td>en</td>\n",
       "      <td>Tampa, FL</td>\n",
       "      <td>Sonny</td>\n",
       "      <td>http://pbs.twimg.com/profile_images/6673098123...</td>\n",
       "      <td>SonnyMendoza</td>\n",
       "      <td>737</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  create_at  favorite_count  geo_tag_city_id geo_tag_city_name  geo_tag_county_id geo_tag_county_name  geo_tag_state_id geo_tag_state_name                  id  in_reply_to_status  in_reply_to_user  is_retweet lang  place_country place_country_code   place_full_name          place_id    place_name place_place_type  retweet_count                                               text user_create_at                                   user_description  user_followers_count  user_friends_count    user_id user_lang                user_location            user_name                             user_profile_image_url user_screen_name  user_statues_count\n",
       "0  2016-01-01T00:00:27.000Z               0        1230000.0           Hialeah              12086          Miami-Dade                12            Florida  682712957118185473                  -1                -1       False   en  United States      United States       Hialeah, FL  629f4a26fed69cd3       Hialeah             city              0  Tryna get it in real quick before the turn up....     2010-10-08  Music Producer...Engineer....Winner..Productio...                  5205                1745  200013652        en      Where ever the wave at.               Chize.  http://pbs.twimg.com/profile_images/6681745180...    ChizeOfficial                6181\n",
       "1  2016-01-01T00:02:31.000Z               0         620018.0            Dublin               6001             Alameda                 6         California  682713477715120128                  -1                -1       False   en  United States      United States        Dublin, CA  003253f0107acd32        Dublin             city              0  I'm running off on the plug right now https://...     2009-06-03                                               null                  1942                1266   44515193        en               229✊- 478- 850   Brute Black Boobie  http://pbs.twimg.com/profile_images/6782158858...      BuddyNoLove              145115\n",
       "2  2016-01-01T00:03:24.000Z               0        5148952.0          Manassas              51683            Manassas                51           Virginia  682713698272677888  682713447738568705          71644485       False   en  United States      United States      Manassas, VA  1f703799b3940c20      Manassas             city              0  @Twittles23 I plan on running around Katsucon ...     2008-06-09           Hentai NSX, lifting, food, cats, waifus.                    49                  55   15066662        en                     Virginia         cosplayerkyo  http://pbs.twimg.com/profile_images/6772800631...     cosplayerkyo                1621\n",
       "3  2016-01-01T00:06:42.000Z               0        1250575.0      Oakland Park              12011             Broward                12            Florida  682714528413540352  682713382223507457        1853895816       False   en  United States      United States  Oakland Park, FL  b230af2256484995  Oakland Park             city              0  @KittyKnits Could be worse. I'm waiting for th...     2009-06-27                                               null                  1625                2039   51540429        en  Ft. Lauderdale, Florida USA       Ray Lauderback  http://pbs.twimg.com/profile_images/5936642848...           okfor1               20210\n",
       "4  2016-01-01T00:09:10.000Z               0        5351300.0           Olympia              53067            Thurston                53         Washington  682715151015907328                  -1                -1       False   en  United States      United States       Olympia, WA  375aa1ab4abd79b1       Olympia             city              0  Wishing you a happy and healthy 2016! See you ...     2012-10-06  The Capital City Marathon, Half Marathon, 5 Mi...                   151                 251  865405321        en                  Olympia, WA  CapitalCityMarathon  http://pbs.twimg.com/profile_images/5226124486...  CapCityMarathon                 336\n",
       "5  2016-01-01T00:09:51.000Z               0        1304000.0           Atlanta              13121              Fulton                13            Georgia  682715319975211008                  -1                -1       False   en  United States      United States       Atlanta, GA  8173485c72e78ca5       Atlanta             city              0  Last person in the gym for the year! 💁🏻 @ L A ...     2010-10-25                                take me to the gym?                    30                  58  207546325        en                  Atlanta, GA         Morgan Brown  http://pbs.twimg.com/profile_images/6824350692...      m0rgancar0l                  25\n",
       "6  2016-01-01T00:10:00.000Z               0        1208150.0           Brandon              12057        Hillsborough                12            Florida  682715359535824896                  -1                -1       False   en  United States      United States      Florida, USA  4ec01c9dbc693497       Florida            admin              0  #sanctuary (@ Fitness for $10 in Brandon, FL) ...     2009-03-24  Just a small town girl. Living in a lonely world.                   162                 282   26328877        en                    Tampa, FL                Sonny  http://pbs.twimg.com/profile_images/6673098123...     SonnyMendoza                 737"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option('display.max_rows', 900)\n",
    "pd.set_option('display.max_columns', 900)\n",
    "pd.set_option('display.width', 1000)\n",
    "twitter.head(7)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Population Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>California Cities by Population Rank</th>\n",
       "      <th>City</th>\n",
       "      <th>Population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>3,949,776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>1,390,966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>San Jose</td>\n",
       "      <td>1,023,031</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>864,263</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Fresno</td>\n",
       "      <td>519,037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Sacramento</td>\n",
       "      <td>489,650</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Long Beach</td>\n",
       "      <td>470,489</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Oakland</td>\n",
       "      <td>417,442</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>Bakersfield</td>\n",
       "      <td>372,680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Anaheim</td>\n",
       "      <td>349,007</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  California Cities by Population Rank           City Population\n",
       "0                                    1    Los Angeles  3,949,776\n",
       "1                                    2      San Diego  1,390,966\n",
       "2                                    3       San Jose  1,023,031\n",
       "3                                    4  San Francisco    864,263\n",
       "4                                    5         Fresno    519,037\n",
       "5                                    6     Sacramento    489,650\n",
       "6                                    7     Long Beach    470,489\n",
       "7                                    8        Oakland    417,442\n",
       "8                                    9    Bakersfield    372,680\n",
       "9                                   10        Anaheim    349,007"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "population=pd.read_csv(\"pouplation3.csv\")\n",
    "population.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Income Data "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PLACE</th>\n",
       "      <th>COUNTY</th>\n",
       "      <th>POPULATION</th>\n",
       "      <th>POPULATION DENSITY</th>\n",
       "      <th>PER CAPITA INCOME</th>\n",
       "      <th>MEDIAN HOUSEHOLD INCOME</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>3,862,210</td>\n",
       "      <td>8,240.80</td>\n",
       "      <td>$28,320</td>\n",
       "      <td>$49,682</td>\n",
       "      <td>$54,171</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>San Diego</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>1,341,510</td>\n",
       "      <td>4,125.30</td>\n",
       "      <td>$33,789</td>\n",
       "      <td>$65,753</td>\n",
       "      <td>$78,414</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>San Jose</td>\n",
       "      <td>Santa Clara</td>\n",
       "      <td>986,320</td>\n",
       "      <td>5,586.00</td>\n",
       "      <td>$34,992</td>\n",
       "      <td>$83,787</td>\n",
       "      <td>$92,379</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>San Francisco</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>829,072</td>\n",
       "      <td>17,680.10</td>\n",
       "      <td>$49,986</td>\n",
       "      <td>$78,378</td>\n",
       "      <td>$93,391</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Fresno</td>\n",
       "      <td>Fresno</td>\n",
       "      <td>506,132</td>\n",
       "      <td>4,470.20</td>\n",
       "      <td>$19,226</td>\n",
       "      <td>$41,455</td>\n",
       "      <td>$45,554</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Sacramento</td>\n",
       "      <td>Sacramento</td>\n",
       "      <td>476,075</td>\n",
       "      <td>4,861.70</td>\n",
       "      <td>$26,060</td>\n",
       "      <td>$50,013</td>\n",
       "      <td>$57,200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Long Beach</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>468,594</td>\n",
       "      <td>9,315.80</td>\n",
       "      <td>$27,014</td>\n",
       "      <td>$52,944</td>\n",
       "      <td>$59,710</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Oakland</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>402,339</td>\n",
       "      <td>7,198.40</td>\n",
       "      <td>$32,566</td>\n",
       "      <td>$52,962</td>\n",
       "      <td>$60,472</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Bakersfield</td>\n",
       "      <td>Kern</td>\n",
       "      <td>358,700</td>\n",
       "      <td>2,414.70</td>\n",
       "      <td>$23,786</td>\n",
       "      <td>$56,842</td>\n",
       "      <td>$61,994</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Anaheim</td>\n",
       "      <td>Orange</td>\n",
       "      <td>342,973</td>\n",
       "      <td>6,862.60</td>\n",
       "      <td>$23,990</td>\n",
       "      <td>$59,707</td>\n",
       "      <td>$63,281</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           PLACE         COUNTY POPULATION POPULATION DENSITY PER CAPITA INCOME MEDIAN HOUSEHOLD INCOME MEDIAN FAMILY INCOME\n",
       "0    Los Angeles    Los Angeles  3,862,210           8,240.80          $28,320                 $49,682              $54,171 \n",
       "1      San Diego      San Diego  1,341,510           4,125.30          $33,789                 $65,753              $78,414 \n",
       "2       San Jose    Santa Clara    986,320           5,586.00          $34,992                 $83,787              $92,379 \n",
       "3  San Francisco  San Francisco    829,072          17,680.10          $49,986                 $78,378              $93,391 \n",
       "4         Fresno         Fresno    506,132           4,470.20          $19,226                 $41,455              $45,554 \n",
       "5     Sacramento     Sacramento    476,075           4,861.70          $26,060                 $50,013              $57,200 \n",
       "6     Long Beach    Los Angeles    468,594           9,315.80          $27,014                 $52,944              $59,710 \n",
       "7        Oakland        Alameda    402,339           7,198.40          $32,566                 $52,962              $60,472 \n",
       "8    Bakersfield           Kern    358,700           2,414.70          $23,786                 $56,842              $61,994 \n",
       "9        Anaheim         Orange    342,973           6,862.60          $23,990                 $59,707              $63,281 "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "income=pd.read_csv(\"income.csv\")\n",
    "income.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Area Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>Type</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Adelanto</td>\n",
       "      <td>City</td>\n",
       "      <td>San Bernardino</td>\n",
       "      <td>145.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Agoura Hills</td>\n",
       "      <td>City</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>20.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Albany</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>4.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Alhambra</td>\n",
       "      <td>City</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>19.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Aliso Viejo</td>\n",
       "      <td>City</td>\n",
       "      <td>Orange</td>\n",
       "      <td>19.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Alturas</td>\n",
       "      <td>City</td>\n",
       "      <td>Modoc</td>\n",
       "      <td>6.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Amador City</td>\n",
       "      <td>City</td>\n",
       "      <td>Amador</td>\n",
       "      <td>0.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>American Canyon</td>\n",
       "      <td>City</td>\n",
       "      <td>Napa</td>\n",
       "      <td>12.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Anaheim</td>\n",
       "      <td>City</td>\n",
       "      <td>Orange</td>\n",
       "      <td>129.1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Name  Type          County   Area\n",
       "0         Adelanto  City  San Bernardino  145.1\n",
       "1     Agoura Hills  City     Los Angeles   20.2\n",
       "2          Alameda  City         Alameda   27.5\n",
       "3           Albany  City         Alameda    4.6\n",
       "4         Alhambra  City     Los Angeles   19.8\n",
       "5      Aliso Viejo  City          Orange   19.3\n",
       "6          Alturas  City           Modoc    6.3\n",
       "7      Amador City  City          Amador    0.8\n",
       "8  American Canyon  City            Napa   12.5\n",
       "9          Anaheim  City          Orange  129.1"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_county=pd.read_csv(\"citycounty3.csv\")\n",
    "city_county.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Air Quality Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>DATA</th>\n",
       "      <th>PLACE</th>\n",
       "      <th>COUNTY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>AQI_VALUE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-04</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>California</td>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         DATA      PLACE   COUNTY       STATE  AQI_VALUE\n",
       "0  2016-01-01  Livermore  Alameda  California         41\n",
       "1  2016-01-02  Livermore  Alameda  California         53\n",
       "2  2016-01-03  Livermore  Alameda  California         72\n",
       "3  2016-01-04  Livermore  Alameda  California         61\n",
       "4  2016-01-05  Livermore  Alameda  California         21\n",
       "5  2016-01-06  Livermore  Alameda  California         17\n",
       "6  2016-01-07  Livermore  Alameda  California         40\n",
       "7  2016-01-08  Livermore  Alameda  California         44\n",
       "8  2016-01-09  Livermore  Alameda  California         40\n",
       "9  2016-01-10  Livermore  Alameda  California         44"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AQI=pd.read_csv(\"export_AQI2.csv\")\n",
    "AQI.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Gender Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fips</th>\n",
       "      <th>county</th>\n",
       "      <th>year</th>\n",
       "      <th>age</th>\n",
       "      <th>pop_female</th>\n",
       "      <th>pop_male</th>\n",
       "      <th>pop_total</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>0</td>\n",
       "      <td>8533</td>\n",
       "      <td>8671</td>\n",
       "      <td>17204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>1</td>\n",
       "      <td>8151</td>\n",
       "      <td>8252</td>\n",
       "      <td>16403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>2</td>\n",
       "      <td>7753</td>\n",
       "      <td>8015</td>\n",
       "      <td>15768</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>3</td>\n",
       "      <td>8018</td>\n",
       "      <td>8412</td>\n",
       "      <td>16430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>4</td>\n",
       "      <td>8551</td>\n",
       "      <td>8648</td>\n",
       "      <td>17199</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>5</td>\n",
       "      <td>9012</td>\n",
       "      <td>9208</td>\n",
       "      <td>18220</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>6</td>\n",
       "      <td>9637</td>\n",
       "      <td>9636</td>\n",
       "      <td>19273</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>7</td>\n",
       "      <td>9561</td>\n",
       "      <td>9713</td>\n",
       "      <td>19274</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>8</td>\n",
       "      <td>9648</td>\n",
       "      <td>10008</td>\n",
       "      <td>19656</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>6001</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>1970</td>\n",
       "      <td>9</td>\n",
       "      <td>9718</td>\n",
       "      <td>10093</td>\n",
       "      <td>19811</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   fips   county  year  age  pop_female  pop_male  pop_total\n",
       "0  6001  ALAMEDA  1970    0        8533      8671      17204\n",
       "1  6001  ALAMEDA  1970    1        8151      8252      16403\n",
       "2  6001  ALAMEDA  1970    2        7753      8015      15768\n",
       "3  6001  ALAMEDA  1970    3        8018      8412      16430\n",
       "4  6001  ALAMEDA  1970    4        8551      8648      17199\n",
       "5  6001  ALAMEDA  1970    5        9012      9208      18220\n",
       "6  6001  ALAMEDA  1970    6        9637      9636      19273\n",
       "7  6001  ALAMEDA  1970    7        9561      9713      19274\n",
       "8  6001  ALAMEDA  1970    8        9648     10008      19656\n",
       "9  6001  ALAMEDA  1970    9        9718     10093      19811"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender=pd.read_csv(\"gender.csv\")\n",
    "gender.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Walk/Bike Scores Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>West Hollywood</td>\n",
       "      <td>NaN</td>\n",
       "      <td>91</td>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>San Francisco</td>\n",
       "      <td>94112.0</td>\n",
       "      <td>86</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Hermosa Beach</td>\n",
       "      <td>90254.0</td>\n",
       "      <td>84</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Santa Monica</td>\n",
       "      <td>90405.0</td>\n",
       "      <td>83</td>\n",
       "      <td>84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Berkeley</td>\n",
       "      <td>94704.0</td>\n",
       "      <td>81</td>\n",
       "      <td>85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Albany</td>\n",
       "      <td>94706.0</td>\n",
       "      <td>80</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Huntington Park</td>\n",
       "      <td>NaN</td>\n",
       "      <td>80</td>\n",
       "      <td>58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Beverly Hills</td>\n",
       "      <td>90212.0</td>\n",
       "      <td>78</td>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Maywood</td>\n",
       "      <td>90270.0</td>\n",
       "      <td>77</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Lawndale</td>\n",
       "      <td>NaN</td>\n",
       "      <td>76</td>\n",
       "      <td>59</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              City  Zip Code  Walk Score  Bike Score\n",
       "0   West Hollywood       NaN          91          54\n",
       "1    San Francisco   94112.0          86          71\n",
       "2    Hermosa Beach   90254.0          84          46\n",
       "3     Santa Monica   90405.0          83          84\n",
       "4         Berkeley   94704.0          81          85\n",
       "5           Albany   94706.0          80          46\n",
       "6  Huntington Park       NaN          80          58\n",
       "7    Beverly Hills   90212.0          78          54\n",
       "8          Maywood   90270.0          77          63\n",
       "9         Lawndale       NaN          76          59"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "exercise=pd.read_csv(\"exercise score 1.csv\")\n",
    "exercise.drop(columns=['Unnamed: 4']).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Holiday Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>DATE</th>\n",
       "      <th>WORKDAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-04</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         DATE  WORKDAY\n",
       "0  2016-01-01      0.0\n",
       "1  2016-01-02      0.0\n",
       "2  2016-01-03      0.0\n",
       "3  2016-01-04      1.0\n",
       "4  2016-01-05      1.0\n",
       "5  2016-01-06      1.0\n",
       "6  2016-01-07      1.0\n",
       "7  2016-01-08      1.0\n",
       "8  2016-01-09      0.0\n",
       "9  2016-01-10      0.0"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "workday=pd.read_csv(\"HOLIDAY.csv\")\n",
    "workday.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Loading Weather Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PLACE</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ELEVATION</th>\n",
       "      <th>PRCP</th>\n",
       "      <th>TMAX</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1032564</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-21</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>83.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032565</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-22</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>79.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032566</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-23</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>76.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032567</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-24</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032568</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-25</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032569</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-26</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>71.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032570</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-27</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032571</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-28</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032572</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-29</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>69.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032573</th>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>2018-04-30</td>\n",
       "      <td>54.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>68.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               PLACE        DATE  ELEVATION  PRCP  TMAX\n",
       "1032564  Los Angeles  2018-04-21       54.6   0.0  83.0\n",
       "1032565  Los Angeles  2018-04-22       54.6   0.0  79.0\n",
       "1032566  Los Angeles  2018-04-23       54.6   0.0  76.0\n",
       "1032567  Los Angeles  2018-04-24       54.6   0.0  70.0\n",
       "1032568  Los Angeles  2018-04-25       54.6   0.0  70.0\n",
       "1032569  Los Angeles  2018-04-26       54.6   0.0  71.0\n",
       "1032570  Los Angeles  2018-04-27       54.6   0.0  70.0\n",
       "1032571  Los Angeles  2018-04-28       54.6   0.0  70.0\n",
       "1032572  Los Angeles  2018-04-29       54.6   0.0  69.0\n",
       "1032573  Los Angeles  2018-04-30       54.6   0.0  68.0"
      ]
     },
     "execution_count": 149,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather=pd.read_csv(\"export_weather2.csv\")\n",
    "weather=weather.drop(columns=['AWND','TAVG','Unnamed: 8','Unnamed: 9','WDF2'])\n",
    "weather.loc[weather['PLACE'] == 'Los Angeles'].tail(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Create New DataFrame to Merge ALL Database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "#twitter['text']=twitter['text'].str.split(' ')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Counts Key Words: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "counts=twitter['text'].str.count(\"running\")+twitter['text'].str.count(\"asthma\")+twitter['text'].str.count(\"outdoor\")+twitter['text'].str.count(\"activity\")+twitter['text'].str.count(\"activities\")+twitter['text'].str.count(\"hiking\")+twitter['text'].str.count(\"jogging\")+twitter['text'].str.count(\"climbing\")+twitter['text'].str.count(\"camping\")+twitter['text'].str.count(\"fishing\")+twitter['text'].str.count(\"hunting\")+twitter['text'].str.count(\"backpacking\")+twitter['text'].str.count(\"biking\")+twitter['text'].str.count(\"Air\")+twitter['text'].str.count(\"air\")+twitter['text'].str.count(\"Pollution\")+twitter['text'].str.count(\"pollution\")+twitter['text'].str.count(\"Running\")+twitter['text'].str.count(\"Asthma\")+twitter['text'].str.count(\"Outdoor\")+twitter['text'].str.count(\"Activity\")+twitter['text'].str.count(\"Activities\")+twitter['text'].str.count(\"Hiking\")+twitter['text'].str.count(\"Jogging\")+twitter['text'].str.count(\"Climbing\")+twitter['text'].str.count(\"Camping\")+twitter['text'].str.count(\"Fishing\")+twitter['text'].str.count(\"Hunting\")+twitter['text'].str.count(\"Backpacking\")+twitter['text'].str.count(\"Biking\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Count Twitter with keywords and create new dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data=pd.DataFrame({'create':twitter.create_at,'geo_tag_city_name':twitter.geo_tag_city_name,'count': counts})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Split 'create' Cretae to get date: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data['create']=merge_data['create'].str.split('T').str[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>514550</th>\n",
       "      <td>2018-05-06</td>\n",
       "      <td>Aaronsburg</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298267</th>\n",
       "      <td>2017-03-27</td>\n",
       "      <td>Aasco</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5230265</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>655547</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5231347</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5884008</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1964501</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3275172</th>\n",
       "      <td>2016-01-12</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4582405</th>\n",
       "      <td>2016-01-12</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5237087</th>\n",
       "      <td>2016-01-12</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>664197</th>\n",
       "      <td>2016-01-17</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2628732</th>\n",
       "      <td>2016-01-24</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5244861</th>\n",
       "      <td>2016-01-24</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4592781</th>\n",
       "      <td>2016-01-28</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4605489</th>\n",
       "      <td>2016-02-16</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>689753</th>\n",
       "      <td>2016-03-01</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1342240</th>\n",
       "      <td>2016-03-01</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1343850</th>\n",
       "      <td>2016-03-03</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>692376</th>\n",
       "      <td>2016-03-04</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3307126</th>\n",
       "      <td>2016-03-06</td>\n",
       "      <td>Abbeville</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             create geo_tag_city_name  count\n",
       "514550   2018-05-06        Aaronsburg      1\n",
       "298267   2017-03-27             Aasco      1\n",
       "5230265  2016-01-02         Abbeville      1\n",
       "655547   2016-01-03         Abbeville      1\n",
       "5231347  2016-01-03         Abbeville      1\n",
       "5884008  2016-01-03         Abbeville      1\n",
       "1964501  2016-01-08         Abbeville      1\n",
       "3275172  2016-01-12         Abbeville      1\n",
       "4582405  2016-01-12         Abbeville      1\n",
       "5237087  2016-01-12         Abbeville      1\n",
       "664197   2016-01-17         Abbeville      1\n",
       "2628732  2016-01-24         Abbeville      1\n",
       "5244861  2016-01-24         Abbeville      1\n",
       "4592781  2016-01-28         Abbeville      1\n",
       "4605489  2016-02-16         Abbeville      1\n",
       "689753   2016-03-01         Abbeville      1\n",
       "1342240  2016-03-01         Abbeville      1\n",
       "1343850  2016-03-03         Abbeville      1\n",
       "692376   2016-03-04         Abbeville      1\n",
       "3307126  2016-03-06         Abbeville      1"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data=merge_data.groupby(['create','geo_tag_city_name'])['count'].sum().reset_index(name=\"counts\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "create               2038429\n",
       "geo_tag_city_name    2038429\n",
       "counts               2038429\n",
       "dtype: int64"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "pouplation=pouplation.drop(columns=['California Cities by Population Rank'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_1= merge_data.merge(pouplation,left_on='geo_tag_city_name', right_on='City')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_1=merge_data_1.drop(columns=['City'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population\n",
       "0  2016-01-01           Alameda       2     78,246\n",
       "1  2016-01-02           Alameda      31     78,246\n",
       "2  2016-01-03           Alameda      22     78,246\n",
       "3  2016-01-05           Alameda      27     78,246\n",
       "4  2016-01-06           Alameda      19     78,246"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_1.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge Income Dataset According to key['geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_2 = merge_data_1.merge(income,left_on='geo_tag_city_name', right_on='PLACE')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>PLACE</th>\n",
       "      <th>COUNTY</th>\n",
       "      <th>POPULATION</th>\n",
       "      <th>POPULATION DENSITY</th>\n",
       "      <th>PER CAPITA INCOME</th>\n",
       "      <th>MEDIAN HOUSEHOLD INCOME</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>75,763</td>\n",
       "      <td>7,255.60</td>\n",
       "      <td>$42,331</td>\n",
       "      <td>$76,439</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>75,763</td>\n",
       "      <td>7,255.60</td>\n",
       "      <td>$42,331</td>\n",
       "      <td>$76,439</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>75,763</td>\n",
       "      <td>7,255.60</td>\n",
       "      <td>$42,331</td>\n",
       "      <td>$76,439</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>75,763</td>\n",
       "      <td>7,255.60</td>\n",
       "      <td>$42,331</td>\n",
       "      <td>$76,439</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>75,763</td>\n",
       "      <td>7,255.60</td>\n",
       "      <td>$42,331</td>\n",
       "      <td>$76,439</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population    PLACE   COUNTY POPULATION POPULATION DENSITY PER CAPITA INCOME MEDIAN HOUSEHOLD INCOME MEDIAN FAMILY INCOME\n",
       "0  2016-01-01           Alameda       2     78,246  Alameda  Alameda     75,763           7,255.60          $42,331                 $76,439              $93,427 \n",
       "1  2016-01-02           Alameda      31     78,246  Alameda  Alameda     75,763           7,255.60          $42,331                 $76,439              $93,427 \n",
       "2  2016-01-03           Alameda      22     78,246  Alameda  Alameda     75,763           7,255.60          $42,331                 $76,439              $93,427 \n",
       "3  2016-01-05           Alameda      27     78,246  Alameda  Alameda     75,763           7,255.60          $42,331                 $76,439              $93,427 \n",
       "4  2016-01-06           Alameda      19     78,246  Alameda  Alameda     75,763           7,255.60          $42,331                 $76,439              $93,427 "
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_2 .head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_3=merge_data_2.drop(columns=['PLACE','COUNTY','POPULATION','POPULATION DENSITY','PER CAPITA INCOME','MEDIAN HOUSEHOLD INCOME'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME\n",
       "0  2016-01-01           Alameda       2     78,246             $93,427 "
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_3.head(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge County Dataset According to key['geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_4 = merge_data_3.merge(city_county,left_on='geo_tag_city_name', right_on='Name')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>Name</th>\n",
       "      <th>Type</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>City</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME     Name  Type   County  Area\n",
       "0  2016-01-01           Alameda       2     78,246             $93,427   Alameda  City  Alameda  27.5\n",
       "1  2016-01-02           Alameda      31     78,246             $93,427   Alameda  City  Alameda  27.5\n",
       "2  2016-01-03           Alameda      22     78,246             $93,427   Alameda  City  Alameda  27.5\n",
       "3  2016-01-05           Alameda      27     78,246             $93,427   Alameda  City  Alameda  27.5\n",
       "4  2016-01-06           Alameda      19     78,246             $93,427   Alameda  City  Alameda  27.5"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_4.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_5=merge_data_4.drop(columns=['Name','Type'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County  Area\n",
       "0  2016-01-01           Alameda       2     78,246             $93,427   Alameda  27.5\n",
       "1  2016-01-02           Alameda      31     78,246             $93,427   Alameda  27.5\n",
       "2  2016-01-03           Alameda      22     78,246             $93,427   Alameda  27.5"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_5.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALPINE</td>\n",
       "      <td>0.609305</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AMADOR</td>\n",
       "      <td>0.557627</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BUTTE</td>\n",
       "      <td>0.671242</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CALAVERAS</td>\n",
       "      <td>0.530425</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      county  percentage\n",
       "0    ALAMEDA    0.676553\n",
       "1     ALPINE    0.609305\n",
       "2     AMADOR    0.557627\n",
       "3      BUTTE    0.671242\n",
       "4  CALAVERAS    0.530425"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gender2 = gender.groupby('county')\n",
    "gender2=gender2.apply(lambda x: x[x['age'] <50]['pop_total'].sum())/gender2.apply(lambda x: x['pop_total'].sum())\n",
    "gender2 = pd.DataFrame(gender2).reset_index()\n",
    "gender2.columns = ['county', 'percentage']\n",
    "gender2.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge Age<50 Dataset According to key['County']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_5['County']=merge_data_5['County'].str.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_6 = merge_data_5.merge(gender2,left_on='County', right_on='county')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_6=merge_data_6.drop(columns=['county'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78,246</td>\n",
       "      <td>$93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County  Area   county  percentage\n",
       "0  2016-01-01           Alameda       2     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "1  2016-01-02           Alameda      31     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "2  2016-01-03           Alameda      22     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "3  2016-01-05           Alameda      27     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "4  2016-01-06           Alameda      19     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "5  2016-01-07           Alameda      21     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "6  2016-01-08           Alameda      31     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "7  2016-01-09           Alameda      40     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "8  2016-01-10           Alameda      20     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553\n",
       "9  2016-01-11           Alameda       1     78,246             $93,427   ALAMEDA  27.5  ALAMEDA    0.676553"
      ]
     },
     "execution_count": 82,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_6.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_6['MEDIAN FAMILY INCOME']=merge_data_6['MEDIAN FAMILY INCOME'].str.lstrip('$') \n",
    "#Make them into numbers instead of string"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge exercise Dataset According to key['geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [],
   "source": [
    "exercise.iloc[32, exercise.columns.get_loc('City')] = 'Los Angeles'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_7 = merge_data_6.merge(exercise,left_on='geo_tag_city_name', right_on='City')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>Unnamed: 4</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>94501.0</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County  Area   county  percentage     City  Zip Code  Walk Score  Bike Score  Unnamed: 4\n",
       "0  2016-01-01           Alameda       2     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "1  2016-01-02           Alameda      31     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "2  2016-01-03           Alameda      22     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "3  2016-01-05           Alameda      27     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "4  2016-01-06           Alameda      19     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "5  2016-01-07           Alameda      21     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "6  2016-01-08           Alameda      31     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "7  2016-01-09           Alameda      40     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "8  2016-01-10           Alameda      20     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN\n",
       "9  2016-01-11           Alameda       1     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553  Alameda   94501.0          65          73         NaN"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_7.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_7=merge_data_7.drop(columns=['City','Zip Code','Unnamed: 4'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County  Area   county  percentage  Walk Score  Bike Score\n",
       "0  2016-01-01           Alameda       2     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "1  2016-01-02           Alameda      31     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "2  2016-01-03           Alameda      22     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "3  2016-01-05           Alameda      27     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "4  2016-01-06           Alameda      19     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "5  2016-01-07           Alameda      21     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "6  2016-01-08           Alameda      31     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "7  2016-01-09           Alameda      40     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "8  2016-01-10           Alameda      20     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73\n",
       "9  2016-01-11           Alameda       1     78,246              93,427   ALAMEDA  27.5  ALAMEDA    0.676553          65          73"
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_7.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge Holiday Dataset According to key['create'']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_8 = merge_data_7.merge(workday,left_on='create', right_on='DATE')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_8 =merge_data_8 .drop(columns=['DATE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78,246</td>\n",
       "      <td>93,427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Berkeley</td>\n",
       "      <td>6</td>\n",
       "      <td>120,179</td>\n",
       "      <td>114,720</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.1</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>81</td>\n",
       "      <td>85</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Dublin</td>\n",
       "      <td>4</td>\n",
       "      <td>57,022</td>\n",
       "      <td>128,737</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>38.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>34</td>\n",
       "      <td>56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Fremont</td>\n",
       "      <td>1</td>\n",
       "      <td>230,964</td>\n",
       "      <td>112,347</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>200.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Hayward</td>\n",
       "      <td>1</td>\n",
       "      <td>156,917</td>\n",
       "      <td>69,415</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>117.4</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>53</td>\n",
       "      <td>52</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>1</td>\n",
       "      <td>88,232</td>\n",
       "      <td>111,950</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>65.2</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>37</td>\n",
       "      <td>64</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Newark</td>\n",
       "      <td>4</td>\n",
       "      <td>45,554</td>\n",
       "      <td>91,103</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>35.9</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>47</td>\n",
       "      <td>45</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Oakland</td>\n",
       "      <td>8</td>\n",
       "      <td>417,442</td>\n",
       "      <td>60,472</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>144.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>72</td>\n",
       "      <td>65</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>San Leandro</td>\n",
       "      <td>1</td>\n",
       "      <td>89,910</td>\n",
       "      <td>76,781</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>34.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>62</td>\n",
       "      <td>55</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Union City</td>\n",
       "      <td>2</td>\n",
       "      <td>74,354</td>\n",
       "      <td>93,050</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>50.4</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County   Area   county  percentage  Walk Score  Bike Score  WORKDAY\n",
       "0  2016-01-01           Alameda       2     78,246              93,427   ALAMEDA   27.5  ALAMEDA    0.676553          65          73      0.0\n",
       "1  2016-01-01          Berkeley       6    120,179             114,720   ALAMEDA   27.1  ALAMEDA    0.676553          81          85      0.0\n",
       "2  2016-01-01            Dublin       4     57,022             128,737   ALAMEDA   38.6  ALAMEDA    0.676553          34          56      0.0\n",
       "3  2016-01-01           Fremont       1    230,964             112,347   ALAMEDA  200.6  ALAMEDA    0.676553          44          49      0.0\n",
       "4  2016-01-01           Hayward       1    156,917              69,415   ALAMEDA  117.4  ALAMEDA    0.676553          53          52      0.0\n",
       "5  2016-01-01         Livermore       1     88,232             111,950   ALAMEDA   65.2  ALAMEDA    0.676553          37          64      0.0\n",
       "6  2016-01-01            Newark       4     45,554              91,103   ALAMEDA   35.9  ALAMEDA    0.676553          47          45      0.0\n",
       "7  2016-01-01           Oakland       8    417,442              60,472   ALAMEDA  144.5  ALAMEDA    0.676553          72          65      0.0\n",
       "8  2016-01-01       San Leandro       1     89,910              76,781   ALAMEDA   34.6  ALAMEDA    0.676553          62          55      0.0\n",
       "9  2016-01-01        Union City       2     74,354              93,050   ALAMEDA   50.4  ALAMEDA    0.676553          44          49      0.0"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_8 .head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_8 ['MEDIAN FAMILY INCOME']=merge_data_8 ['MEDIAN FAMILY INCOME'].str.lstrip('$')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_8 ['MEDIAN FAMILY INCOME']=merge_data_8 ['MEDIAN FAMILY INCOME'].str.replace(\",\",\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_8 ['Population']=merge_data_8 ['Population'].str.replace(\",\",\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County</th>\n",
       "      <th>Area</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Berkeley</td>\n",
       "      <td>6</td>\n",
       "      <td>120179</td>\n",
       "      <td>114720</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>27.1</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>81</td>\n",
       "      <td>85</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Dublin</td>\n",
       "      <td>4</td>\n",
       "      <td>57022</td>\n",
       "      <td>128737</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>38.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>34</td>\n",
       "      <td>56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Fremont</td>\n",
       "      <td>1</td>\n",
       "      <td>230964</td>\n",
       "      <td>112347</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>200.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Hayward</td>\n",
       "      <td>1</td>\n",
       "      <td>156917</td>\n",
       "      <td>69415</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>117.4</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>53</td>\n",
       "      <td>52</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>1</td>\n",
       "      <td>88232</td>\n",
       "      <td>111950</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>65.2</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>37</td>\n",
       "      <td>64</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Newark</td>\n",
       "      <td>4</td>\n",
       "      <td>45554</td>\n",
       "      <td>91103</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>35.9</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>47</td>\n",
       "      <td>45</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Oakland</td>\n",
       "      <td>8</td>\n",
       "      <td>417442</td>\n",
       "      <td>60472</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>144.5</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>72</td>\n",
       "      <td>65</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>San Leandro</td>\n",
       "      <td>1</td>\n",
       "      <td>89910</td>\n",
       "      <td>76781</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>34.6</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>62</td>\n",
       "      <td>55</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Union City</td>\n",
       "      <td>2</td>\n",
       "      <td>74354</td>\n",
       "      <td>93050</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>50.4</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME   County   Area   county  percentage  Walk Score  Bike Score  WORKDAY\n",
       "0  2016-01-01           Alameda       2      78246               93427   ALAMEDA   27.5  ALAMEDA    0.676553          65          73      0.0\n",
       "1  2016-01-01          Berkeley       6     120179              114720   ALAMEDA   27.1  ALAMEDA    0.676553          81          85      0.0\n",
       "2  2016-01-01            Dublin       4      57022              128737   ALAMEDA   38.6  ALAMEDA    0.676553          34          56      0.0\n",
       "3  2016-01-01           Fremont       1     230964              112347   ALAMEDA  200.6  ALAMEDA    0.676553          44          49      0.0\n",
       "4  2016-01-01           Hayward       1     156917               69415   ALAMEDA  117.4  ALAMEDA    0.676553          53          52      0.0\n",
       "5  2016-01-01         Livermore       1      88232              111950   ALAMEDA   65.2  ALAMEDA    0.676553          37          64      0.0\n",
       "6  2016-01-01            Newark       4      45554               91103   ALAMEDA   35.9  ALAMEDA    0.676553          47          45      0.0\n",
       "7  2016-01-01           Oakland       8     417442               60472   ALAMEDA  144.5  ALAMEDA    0.676553          72          65      0.0\n",
       "8  2016-01-01       San Leandro       1      89910               76781   ALAMEDA   34.6  ALAMEDA    0.676553          62          55      0.0\n",
       "9  2016-01-01        Union City       2      74354               93050   ALAMEDA   50.4  ALAMEDA    0.676553          44          49      0.0"
      ]
     },
     "execution_count": 99,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_8 .head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_9 =merge_data_8 .drop(columns=['Area'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge City_County Dataset According to key['geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [],
   "source": [
    "city_county.iloc[121, city_county.columns.get_loc('Area')] = 34"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_10 = merge_data_9.merge(city_county,left_on='geo_tag_city_name', right_on='Name')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_10=merge_data_10.drop(columns=['Name','Type','County_y'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_10['Area']=merge_data_10['Area'].str.replace(\",\",\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County_x</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "      <th>Area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts Population MEDIAN FAMILY INCOME County_x   county  percentage  Walk Score  Bike Score  WORKDAY  Area\n",
       "0  2016-01-01           Alameda       2      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5\n",
       "1  2016-01-02           Alameda      31      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5\n",
       "2  2016-01-03           Alameda      22      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5\n",
       "3  2016-01-05           Alameda      27      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5\n",
       "4  2016-01-06           Alameda      19      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5\n",
       "5  2016-01-07           Alameda      21      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5\n",
       "6  2016-01-08           Alameda      31      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5\n",
       "7  2016-01-09           Alameda      40      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5\n",
       "8  2016-01-10           Alameda      20      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5\n",
       "9  2016-01-11           Alameda       1      78246               93427   ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_10.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Make all numbers to numeric"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_10['MEDIAN FAMILY INCOME']=pd.to_numeric(merge_data_10['MEDIAN FAMILY INCOME'])\n",
    "merge_data_10['Population']=pd.to_numeric(merge_data_10['Population'])\n",
    "merge_data_10['Area']=pd.to_numeric(merge_data_10['Area'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge AQI Dataset According to key['create','geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {},
   "outputs": [],
   "source": [
    "AQI.columns = ['create', 'geo_tag_city_name','County_x','STATE','AQI_VALUE']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [],
   "source": [
    "AQI['County_x']=AQI['County_x'].str.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_11=merge_data_10.merge(AQI,on=['create','geo_tag_city_name'],how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>County_x_x</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "      <th>Area</th>\n",
       "      <th>County_x_y</th>\n",
       "      <th>STATE</th>\n",
       "      <th>AQI_VALUE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts  Population  MEDIAN FAMILY INCOME County_x_x   county  percentage  Walk Score  Bike Score  WORKDAY  Area County_x_y STATE  AQI_VALUE\n",
       "0  2016-01-01           Alameda       2       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5        NaN   NaN        NaN\n",
       "1  2016-01-02           Alameda      31       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5        NaN   NaN        NaN\n",
       "2  2016-01-03           Alameda      22       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5        NaN   NaN        NaN\n",
       "3  2016-01-05           Alameda      27       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5        NaN   NaN        NaN\n",
       "4  2016-01-06           Alameda      19       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5        NaN   NaN        NaN\n",
       "5  2016-01-07           Alameda      21       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5        NaN   NaN        NaN\n",
       "6  2016-01-08           Alameda      31       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5        NaN   NaN        NaN\n",
       "7  2016-01-09           Alameda      40       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5        NaN   NaN        NaN\n",
       "8  2016-01-10           Alameda      20       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      0.0  27.5        NaN   NaN        NaN\n",
       "9  2016-01-11           Alameda       1       78246                 93427    ALAMEDA  ALAMEDA    0.676553          65          73      1.0  27.5        NaN   NaN        NaN"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_11.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_11=merge_data_11.drop(columns=['STATE','County_x_y','County_x_x'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "      <th>Area</th>\n",
       "      <th>AQI_VALUE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       create geo_tag_city_name  counts  Population  MEDIAN FAMILY INCOME   county  percentage  Walk Score  Bike Score  WORKDAY  Area  AQI_VALUE\n",
       "0  2016-01-01           Alameda       2       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN\n",
       "1  2016-01-02           Alameda      31       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN\n",
       "2  2016-01-03           Alameda      22       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN\n",
       "3  2016-01-05           Alameda      27       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN\n",
       "4  2016-01-06           Alameda      19       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN\n",
       "5  2016-01-07           Alameda      21       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN\n",
       "6  2016-01-08           Alameda      31       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN\n",
       "7  2016-01-09           Alameda      40       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN\n",
       "8  2016-01-10           Alameda      20       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN\n",
       "9  2016-01-11           Alameda       1       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN"
      ]
     },
     "execution_count": 120,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_11.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [],
   "source": [
    "weather=weather.drop(columns=['AWND','TAVG','WDF2','Unnamed: 8','Unnamed: 9'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PLACE</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ELEVATION</th>\n",
       "      <th>PRCP</th>\n",
       "      <th>TMAX</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-04</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.72</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.94</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.60</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.09</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Piedmont</td>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>113.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      PLACE        DATE  ELEVATION  PRCP  TMAX\n",
       "0  Piedmont  2016-01-01      113.4  0.00   NaN\n",
       "1  Piedmont  2016-01-02      113.4  0.00   NaN\n",
       "2  Piedmont  2016-01-03      113.4  0.00   NaN\n",
       "3  Piedmont  2016-01-04      113.4  0.05   NaN\n",
       "4  Piedmont  2016-01-05      113.4  0.72   NaN\n",
       "5  Piedmont  2016-01-06      113.4  0.94   NaN\n",
       "6  Piedmont  2016-01-07      113.4  0.60   NaN\n",
       "7  Piedmont  2016-01-08      113.4  0.00   NaN\n",
       "8  Piedmont  2016-01-09      113.4  0.09   NaN\n",
       "9  Piedmont  2016-01-10      113.4  0.00   NaN"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {},
   "outputs": [],
   "source": [
    "weather.columns = ['geo_tag_city_name','create','ELEVATION','PRCP','TMAX']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Merge Weather Dataset According to key['create','geo_tag_city_name']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_12=merge_data_11.merge(weather,on=['create','geo_tag_city_name'],how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "create                  2254859\n",
       "geo_tag_city_name       2254859\n",
       "counts                  2254859\n",
       "Population              2254859\n",
       "MEDIAN FAMILY INCOME    2254859\n",
       "county                  2254859\n",
       "percentage              2254859\n",
       "Walk Score              2254859\n",
       "Bike Score              2254859\n",
       "WORKDAY                 2254859\n",
       "Area                    2254105\n",
       "AQI_VALUE               1528823\n",
       "ELEVATION_x             2126153\n",
       "PRCP_x                  1979785\n",
       "TMAX_x                   665410\n",
       "ELEVATION_y             2126153\n",
       "PRCP_y                  1979785\n",
       "TMAX_y                   665410\n",
       "dtype: int64"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_12.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_13=merge_data_13.drop(columns=['ELEVATION_y','PRCP_y','TMAX_y'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Add Season Factor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_13['season']=None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_13.loc[merge_data_13['create'].str.contains('-12-'),'season'] = 'winter'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-01-'),'season'] = 'winter'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-02-'),'season'] = 'winter'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-03-'),'season'] = 'spring'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-04-'),'season'] = 'spring'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-05-'),'season'] = 'spring'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-06-'),'season'] = 'summer'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-07-'),'season'] = 'summer'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-08-'),'season'] = 'summer'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-09-'),'season'] = 'fall'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-10-'),'season'] = 'fall'\n",
    "merge_data_13.loc[merge_data_13['create'].str.contains('-11-'),'season'] = 'fall'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_13['create']=pd.to_datetime(merge_data_13['create'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>MEDIAN FAMILY INCOME</th>\n",
       "      <th>county</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk Score</th>\n",
       "      <th>Bike Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "      <th>Area</th>\n",
       "      <th>AQI_VALUE</th>\n",
       "      <th>ELEVATION_x</th>\n",
       "      <th>PRCP_x</th>\n",
       "      <th>TMAX_x</th>\n",
       "      <th>season</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-02</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016-01-03</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>22</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016-01-05</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>27</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016-01-06</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>19</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-07</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>21</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-08</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>31</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2016-01-09</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>40</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2016-01-10</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>20</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>1</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>ALAMEDA</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>1.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>winter</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      create geo_tag_city_name  counts  Population  MEDIAN FAMILY INCOME   county  percentage  Walk Score  Bike Score  WORKDAY  Area  AQI_VALUE  ELEVATION_x  PRCP_x  TMAX_x  season\n",
       "0 2016-01-01           Alameda       2       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "1 2016-01-02           Alameda      31       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "2 2016-01-03           Alameda      22       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "3 2016-01-05           Alameda      27       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "4 2016-01-06           Alameda      19       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "5 2016-01-07           Alameda      21       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "6 2016-01-08           Alameda      31       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "7 2016-01-09           Alameda      40       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "8 2016-01-10           Alameda      20       78246                 93427  ALAMEDA    0.676553          65          73      0.0  27.5        NaN          NaN     NaN     NaN  winter\n",
       "9 2016-01-11           Alameda       1       78246                 93427  ALAMEDA    0.676553          65          73      1.0  27.5        NaN          NaN     NaN     NaN  winter"
      ]
     },
     "execution_count": 136,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_13.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [],
   "source": [
    "fillna=merge_data_13.groupby('create').mean().reset_index()\n",
    "fillna=fillna.drop(columns=['counts','Population','MEDIAN FAMILY INCOME','percentage','Walk Score','Bike Score','WORKDAY','Area'])\n",
    "fillna['create']=pd.to_datetime(fillna['create'])\n",
    "merge_data_13['create']=pd.to_datetime(merge_data_13['create'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_14=merge_data_13.merge(fillna, left_on='create', right_on='create')\n",
    "merge_data_14.AQI_VALUE_x.fillna(merge_data_14.AQI_VALUE_y, inplace=True)\n",
    "merge_data_14.ELEVATION_x_x.fillna(merge_data_14.ELEVATION_x_y, inplace=True)\n",
    "merge_data_14.PRCP_x_x.fillna(merge_data_14.PRCP_x_y, inplace=True)\n",
    "merge_data_14.TMAX_x_x.fillna(merge_data_14.TMAX_x_y, inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Change the name of the variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_14=merge_data_14.drop(columns=['AQI_VALUE_y','ELEVATION_x_y','PRCP_x_y','TMAX_x_y'])\n",
    "merge_data_14=merge_data_14.dropna()\n",
    "merge_data_14=merge_data_14.drop_duplicates(['create','geo_tag_city_name'])\n",
    "merge_data_14.columns =['create',\"geo_tag_city_name\",\"counts\",'Population',\"INCOME\",'county',\"percentage\",\"Walk_Score\",\"Bike_Score\",\"WORKDAY\",\"Area\",\"AQI_VALUE\",\"ELEVATION\",\"PRCP\",\"TMAX\",\"season\"]\n",
    "merge_data_14=merge_data_14.drop(columns=['county'])\n",
    "merge_data_14['season'] = merge_data_14['season'].astype(\"category\").cat.codes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Normalize the population data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "merge_data_14['COUNT_BY_POPULATION'] = 100000*merge_data_14['counts']/merge_data_14['Population']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>create</th>\n",
       "      <th>geo_tag_city_name</th>\n",
       "      <th>counts</th>\n",
       "      <th>Population</th>\n",
       "      <th>INCOME</th>\n",
       "      <th>percentage</th>\n",
       "      <th>Walk_Score</th>\n",
       "      <th>Bike_Score</th>\n",
       "      <th>WORKDAY</th>\n",
       "      <th>Area</th>\n",
       "      <th>AQI_VALUE</th>\n",
       "      <th>ELEVATION</th>\n",
       "      <th>PRCP</th>\n",
       "      <th>TMAX</th>\n",
       "      <th>season</th>\n",
       "      <th>COUNT_BY_POPULATION</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Alameda</td>\n",
       "      <td>2</td>\n",
       "      <td>78246</td>\n",
       "      <td>93427</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>65</td>\n",
       "      <td>73</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.5</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>2.556041</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Berkeley</td>\n",
       "      <td>6</td>\n",
       "      <td>120179</td>\n",
       "      <td>114720</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>81</td>\n",
       "      <td>85</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.1</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>349.900000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>4.992553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Dublin</td>\n",
       "      <td>4</td>\n",
       "      <td>57022</td>\n",
       "      <td>128737</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>34</td>\n",
       "      <td>56</td>\n",
       "      <td>0.0</td>\n",
       "      <td>38.6</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>7.014836</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Fremont</td>\n",
       "      <td>1</td>\n",
       "      <td>230964</td>\n",
       "      <td>112347</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "      <td>200.6</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>9.100000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>0.432968</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Hayward</td>\n",
       "      <td>1</td>\n",
       "      <td>156917</td>\n",
       "      <td>69415</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>53</td>\n",
       "      <td>52</td>\n",
       "      <td>0.0</td>\n",
       "      <td>117.4</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>0.637280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Livermore</td>\n",
       "      <td>1</td>\n",
       "      <td>88232</td>\n",
       "      <td>111950</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>37</td>\n",
       "      <td>64</td>\n",
       "      <td>0.0</td>\n",
       "      <td>65.2</td>\n",
       "      <td>41.000000</td>\n",
       "      <td>146.300000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>46.000000</td>\n",
       "      <td>3</td>\n",
       "      <td>1.133376</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Newark</td>\n",
       "      <td>4</td>\n",
       "      <td>45554</td>\n",
       "      <td>91103</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>47</td>\n",
       "      <td>45</td>\n",
       "      <td>0.0</td>\n",
       "      <td>35.9</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>8.780788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Oakland</td>\n",
       "      <td>8</td>\n",
       "      <td>417442</td>\n",
       "      <td>60472</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>72</td>\n",
       "      <td>65</td>\n",
       "      <td>0.0</td>\n",
       "      <td>144.5</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>120.400000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>1.916434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>168</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>San Leandro</td>\n",
       "      <td>1</td>\n",
       "      <td>89910</td>\n",
       "      <td>76781</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>62</td>\n",
       "      <td>55</td>\n",
       "      <td>0.0</td>\n",
       "      <td>34.6</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>1.112223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>169</th>\n",
       "      <td>2016-01-01</td>\n",
       "      <td>Union City</td>\n",
       "      <td>2</td>\n",
       "      <td>74354</td>\n",
       "      <td>93050</td>\n",
       "      <td>0.676553</td>\n",
       "      <td>44</td>\n",
       "      <td>49</td>\n",
       "      <td>0.0</td>\n",
       "      <td>50.4</td>\n",
       "      <td>50.271697</td>\n",
       "      <td>155.045081</td>\n",
       "      <td>0.0</td>\n",
       "      <td>57.356678</td>\n",
       "      <td>3</td>\n",
       "      <td>2.689835</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        create geo_tag_city_name  counts  Population  INCOME  percentage  Walk_Score  Bike_Score  WORKDAY   Area  AQI_VALUE   ELEVATION  PRCP       TMAX  season  COUNT_BY_POPULATION\n",
       "0   2016-01-01           Alameda       2       78246   93427    0.676553          65          73      0.0   27.5  50.271697  155.045081   0.0  57.356678       3             2.556041\n",
       "1   2016-01-01          Berkeley       6      120179  114720    0.676553          81          85      0.0   27.1  50.271697  349.900000   0.0  57.356678       3             4.992553\n",
       "5   2016-01-01            Dublin       4       57022  128737    0.676553          34          56      0.0   38.6  50.271697  155.045081   0.0  57.356678       3             7.014836\n",
       "6   2016-01-01           Fremont       1      230964  112347    0.676553          44          49      0.0  200.6  50.271697    9.100000   0.0  57.356678       3             0.432968\n",
       "15  2016-01-01           Hayward       1      156917   69415    0.676553          53          52      0.0  117.4  50.271697  155.045081   0.0  57.356678       3             0.637280\n",
       "16  2016-01-01         Livermore       1       88232  111950    0.676553          37          64      0.0   65.2  41.000000  146.300000   0.0  46.000000       3             1.133376\n",
       "20  2016-01-01            Newark       4       45554   91103    0.676553          47          45      0.0   35.9  50.271697  155.045081   0.0  57.356678       3             8.780788\n",
       "21  2016-01-01           Oakland       8      417442   60472    0.676553          72          65      0.0  144.5  13.000000  120.400000   0.0  57.356678       3             1.916434\n",
       "168 2016-01-01       San Leandro       1       89910   76781    0.676553          62          55      0.0   34.6  50.271697  155.045081   0.0  57.356678       3             1.112223\n",
       "169 2016-01-01        Union City       2       74354   93050    0.676553          44          49      0.0   50.4  50.271697  155.045081   0.0  57.356678       3             2.689835"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merge_data_14.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Export the new full dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [],
   "source": [
    "export_csv = merge_data_14.to_csv (r'fulltextdata_2.csv', index = None, header=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
